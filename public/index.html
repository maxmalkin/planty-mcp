<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>planty-mcp</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}
			body {
				font-family: "Courier New", Courier, monospace;
				background: #0a0a0a;
				color: #c0c0c0;
				min-height: 100vh;
				display: flex;
				align-items: center;
				justify-content: center;
				padding: 20px;
				line-height: 1.6;
			}
			.container {
				max-width: 700px;
				width: 100%;
				text-align: center;
			}
			h1 {
				font-size: 2em;
				font-weight: bold;
				color: #ffffff;
				margin-bottom: 40px;
				letter-spacing: 2px;
			}
			.ascii-plant {
				font-size: 14px;
				line-height: 1.2;
				margin: 30px 0;
				white-space: pre;
			}
			.green {
				color: #4ade80;
				font-weight: 900;
			}
			.yellow {
				color: #facc15;
				font-weight: 900;
			}
			.red {
				color: #f87171;
				font-weight: 900;
			}
			.tagline {
				font-size: 1em;
				margin: 30px 0 15px 0;
				color: #a0a0a0;
				font-weight: 900;
			}
			.description {
				font-size: 0.9em;
				color: #808080;
				margin-bottom: 40px;
				font-weight: 900;
			}
			.btn {
				background: transparent;
				color: #4ade80;
				border: 1px solid #4ade80;
				padding: 12px 24px;
				font-family: "Courier New", Courier, monospace;
				font-size: 14px;
				cursor: pointer;
				transition: all 0.2s;
				margin: 10px 0;
			}
			.btn:hover {
				background: #4ade80;
				color: #0a0a0a;
			}
			.btn:disabled {
				border-color: #404040;
				color: #404040;
				cursor: not-allowed;
			}
			.btn:disabled:hover {
				background: transparent;
				color: #404040;
			}
			.key-display {
				margin-top: 40px;
				text-align: left;
				display: none;
			}
			.key-display.show {
				display: block;
			}
			.section-title {
				color: #ffffff;
				font-weight: bold;
				margin: 20px 0 10px 0;
			}
			.api-key {
				background: #1a1a1a;
				border: 1px solid #333;
				padding: 15px;
				margin: 10px 0;
				word-break: break-all;
				color: #4ade80;
				font-size: 13px;
			}
			.info-box {
				background: #1a1a1a;
				border: 1px solid #333;
				padding: 15px;
				margin: 10px 0;
			}
			.info-box strong {
				color: #ffffff;
				display: block;
				margin-bottom: 5px;
			}
			.info-box code {
				color: #4ade80;
				font-size: 13px;
			}
			.warning {
				color: #f87171;
				font-size: 13px;
				margin: 10px 0;
			}
			input {
				width: 100%;
				padding: 12px;
				background: #1a1a1a;
				border: 1px solid #333;
				color: #c0c0c0;
				font-family: "Courier New", Courier, monospace;
				font-size: 14px;
				margin: 10px 0;
			}
			input:focus {
				outline: none;
				border-color: #4ade80;
			}
			.success {
				color: #4ade80;
				margin-top: 10px;
			}
			.divider {
				border-top: 1px solid #333;
				margin: 30px 0;
			}
			a {
				color: #4ade80;
				text-decoration: none;
			}
			a:hover {
				text-decoration: underline;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h1>planty-mcp</h1>

			<div class="ascii-plant">
<span class="green">     /\</span>              <span class="yellow">    ////</span>              <span class="green">   \|/</span>
<span class="green">    //\\</span>             <span class="yellow">   //  \\</span>             <span class="green">    |</span>
<span class="yellow">   ||  ||</span>            <span class="green">  ||    ||</span>            <span class="yellow">    |</span>
<span class="yellow">   ||  ||</span>            <span class="green">  ||    ||</span>            <span class="yellow">   / \</span>
<span class="green">   ||  ||</span>            <span class="green">//||    ||\\</span>           <span class="green">  // \\</span>
<span class="green">   ||  ||</span>           <span class="green">// ||    || \\</span>          <span class="green"> //   \\</span>
<span class="green">   ||  ||</span>           <span class="green">||  ||    ||  ||</span>         <span class="green"> ||   ||</span>
<span class="red">  ========</span>          <span class="red">========== ======</span>        <span class="red">=========</span>
<span class="red">  |      |</span>          <span class="red">|        | |    |</span>        <span class="red">|       |</span>
<span class="red">  |      |</span>          <span class="red">|        | |    |</span>        <span class="red">|       |</span>
<span class="red">  |______|</span>          <span class="red">|________| |____|</span>        <span class="red">|_______|</span>
			</div>

			<p class="tagline">MCP server for your plants</p>
			<p class="description">
				Manage your plants, watering schedules, growth tracking, and care notes
			</p>

			<button class="btn" id="generateBtn" onclick="generateKey()">
				[ GENERATE API KEY ]
			</button>

			<div class="key-display" id="keyDisplay">
				<div class="section-title">&gt; YOUR API KEY</div>
				<div class="api-key" id="apiKey"></div>
				<button class="btn" onclick="copyKey()">[ COPY TO CLIPBOARD ]</button>
				<p class="warning">
					! Save this key. You won't be able to see it again.
				</p>

				<div class="divider"></div>

				<div class="section-title">&gt; SETUP INSTRUCTIONS</div>
				<p class="description">
					Add this MCP server to Claude Desktop or ChatGPT:
				</p>

				<div class="info-box">
					<strong>ENDPOINT:</strong>
					<code>https://planty-mcp.onrender.com/sse</code>
				</div>

				<div class="info-box">
					<strong>API KEY:</strong>
					<code id="apiKeyInstructions"></code>
				</div>

				<div class="divider"></div>

				<div class="section-title">&gt; OPTIONAL: EMAIL RECOVERY</div>
				<input type="email" id="emailInput" placeholder="your@email.com" />
				<button class="btn" onclick="addEmail()">[ SAVE EMAIL ]</button>
				<p class="success" id="emailSuccess" style="display: none">
					âœ“ Email saved
				</p>
			</div>
		</div>

		<script>
			let currentApiKey = "";

			async function generateKey() {
				const btn = document.getElementById("generateBtn");
				btn.disabled = true;
				btn.textContent = "Generating...";

				try {
					const response = await fetch("/api/generate-key", {
						method: "POST",
						headers: { "Content-Type": "application/json" },
					});

					const data = await response.json();

					if (!response.ok || data.error) {
						throw new Error(data.error || `Server error: ${response.status}`);
					}

					if (!data.apiKey) {
						throw new Error("No API key received from server");
					}

					currentApiKey = data.apiKey;

					document.getElementById("apiKey").textContent = currentApiKey;
					document.getElementById("apiKeyInstructions").textContent =
						currentApiKey;
					document.getElementById("keyDisplay").classList.add("show");
					btn.style.display = "none";
				} catch (error) {
					alert(`Error: ${error.message || "Failed to generate API key. Please try again."}`);
					btn.disabled = false;
					btn.textContent = "[ GENERATE API KEY ]";
				}
			}

			function copyKey() {
				navigator.clipboard.writeText(currentApiKey);
				alert("API key copied to clipboard!");
			}

			async function addEmail() {
				const email = document.getElementById("emailInput").value;
				if (!email) return;

				try {
					const response = await fetch("/api/add-email", {
						method: "POST",
						headers: {
							"Content-Type": "application/json",
							Authorization: `Bearer ${currentApiKey}`,
						},
						body: JSON.stringify({ email }),
					});

					if (response.ok) {
						document.getElementById("emailSuccess").style.display = "block";
					} else {
						const data = await response.json();
						alert(data.error || "Failed to add email");
					}
				} catch (error) {
					alert("Error adding email. Please try again.");
				}
			}
		</script>
	</body>
</html>
